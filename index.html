<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name='viewport' content='width=device-width,initial-scale=1'>
    <meta name="description" content="Star polygons generation tool based on vertices and turning point(s)."/>
    <meta name="keywords" content="stars, polygons, geometry, generator, ratios, proportions, golden ratio">
    <title>Star polygons</title>
    <style>body{font-family:Georgia,serif;font-size:12px;color:#000}button,input{margin-bottom:5px}label{min-width:120px;display:inline-block}table{border-collapse:collapse}td div{padding:0 5px}td:first-child div{padding:0 5px 0 0}</style>
</head>
<body>
<form action="javascript:draw()">
    <label for="p">p <small>vertices</small></label><input id="p" type="number" min="1" value="5"/><br/>
    <label for="q0">q<sub>0</sub> <small>turning number</small></label><input id="q0" type="number" min="1" value="1"/><br/>
    <span id="additional_qs"></span>
    <button onclick="addQ();return false;">Add q</button><button onclick="removeQ();return false;">Del q</button><br/>
    <label for="r">r <small>radius</small></label><input id="r" type="number" min="0" value="1"/><br/>
    <label for="scale">scale</label><input id="scale" type="number" min="1" value="200"/><br/>
    <button type="submit">Submit</button>
</form>
<table>
    <tr>
        <td id="edges"></td>
        <td id="angles_rad"></td>
        <td id="angles_deg"></td>
        <td id="intersections"></td>
        <td id="ratios_ext"></td>
        <td id="ratios_int"></td>
        <td id="ratio"></td>
    </tr>
</table>
<div id="container"></div>
<script>function addQ(){if(!(qCount+2>parseInt(document.getElementById("p").value,10)))return++qCount,document.getElementById("additional_qs").insertAdjacentHTML("beforeend",`<span id="q${qCount}container"><label for="q${qCount}">q<sub>${qCount}</sub></label><input id="q${qCount}" type="number" min="1" value="1"/><br/></span>`)}function removeQ(){!(qCount<1)&&(document.getElementById(`q${qCount}container`).remove(),--qCount)}function resetCanvas(){document.getElementById("container").innerHTML="",document.getElementById("container").innerHTML='<canvas id="canvas" height="2000" width="2000"></canvas>'}function resetResults(){document.getElementById("edges").innerHTML="",document.getElementById("angles_rad").innerHTML="",document.getElementById("angles_deg").innerHTML="",document.getElementById("intersections").innerHTML="",document.getElementById("ratios_ext").innerHTML="",document.getElementById("ratios_int").innerHTML=""}function drawPoint(a,g,h,b="",c="#000",d=1){let e=Math.round(g),f=Math.round(h);if(a.beginPath(),a.fillStyle=c,a.arc(e,f,d,0,2*Math.PI),a.fill(),""!==b){let i=e,j=Math.round(f-d-3);a.font="Italic 10px Georgia",a.fillStyle=c,a.textAlign="center",a.fillText(b,i,j)}}function drawLabel(a,b,c,d,e,f,g="#000"){a.font="Italic 10px Georgia",a.fillStyle=g,a.textAlign="center",a.fillText(f,Math.round(b+d),Math.round(c+e))}function drawLine(a,b,c,d,e,f="",h="#000",g=1){if(a.strokeStyle="#000",a.lineWidth=g,a.beginPath(),a.moveTo(b,c),a.lineTo(d,e),a.stroke(),""!==f){let i=Math.round((d+b)/2),j=Math.round((e+c)/2-g-3);a.font="Italic 10px Georgia",a.fillStyle=h,a.textAlign="center",a.fillText(f,i,j)}}function drawCircle(a,b,c,d,e,f,g="#000",h=1){a.strokeStyle=g,a.lineWidth=h,a.beginPath(),a.arc(b,c,d,e,f),a.stroke()}function translateToCanvas(a,b=10){let g=[],h=[];a.forEach(function(a){g.push(a[0]),h.push(a[1])});let d=-1*Math.min(...g),e=-1*Math.min(...h),f=[];for(let c=0,i=a.length;c<i;++c)f.push([a[c][0]+d+b,a[c][1]+e+b]);return[f,[d+b,e+b]]}function dotProductMatrixAndPoint(a,b){let e=a[0],f=a[1],g=a[2],h=a[3],c=b[0],d=b[1];return[c*e+d*g,c*f+d*h]}function rotate(b,a,c="anticlockwise"){return dotProductMatrixAndPoint("anticlockwise"===c?[Math.cos(a),-Math.sin(a),Math.sin(a),Math.cos(a)]:[Math.cos(a),Math.sin(a),-Math.sin(a),Math.cos(a)],b)}function distance(a,b,c,d){return Math.sqrt(Math.pow(c-a,2)+Math.pow(d-b,2))}function vectorLength(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))}function dotProductVectors(a,b){return a[0]*b[0]+a[1]*b[1]}function vector(a,b){return[b[0]-a[0],b[1]-a[1]]}function calcAngle(e,a,f,g="degrees"){let b=vector(a,e),c=vector(a,f),d=Math.acos(dotProductVectors(b,c)/(vectorLength(b)*vectorLength(c)));return"radians"!==g?180*d/Math.PI:d}function round(b,a=4){return Math.round((b+Number.EPSILON)*Math.pow(10,a))/Math.pow(10,a)}function printResult(a,b){document.getElementById(b).insertAdjacentHTML("beforeend",`<div>${a}</div>`)}function calcIntersection(a,c,b,d){let g=(a[0]-b[0])*(b[1]-d[1])-(a[1]-b[1])*(b[0]-d[0]),e=(a[0]-c[0])*(b[1]-d[1])-(a[1]-c[1])*(b[0]-d[0]);if(0===e||g>e||g<0&&e>0||g>0&&e<0)return null;let h=(a[0]-b[0])*(a[1]-c[1])-(a[1]-b[1])*(a[0]-c[0]),f=(a[0]-c[0])*(b[1]-d[1])-(a[1]-c[1])*(b[0]-d[0]);if(0===f||h>f||h<0&&f>0||h>0&&f<0)return null;let i=g/e,j=h/f;return i>1||i<0||j>1||j<0?null:[a[0]+i*(c[0]-a[0]),a[1]+i*(c[1]-a[1])]}function printIntersections(a,i,b,c,d){let g,h,e=distance(a[b][0][0],a[b][0][1],i[0],i[1]),f=a[b][4]-e;e>=f?(g=round(a[b][4]/e),printResult(`p<sub>${a[b][2]}</sub>p<sub>${a[b][3]}</sub>/p<sub>${a[b][2]}</sub>i<sub>${d}</sub>=${g}`,"ratios_ext"),h=round(e/f),printResult(`p<sub>${a[b][2]}</sub>i<sub>${d}</sub>/p<sub>${a[b][3]}</sub>i<sub>${d}</sub>=${h}`,"ratios_int")):(g=round(a[b][4]/f),printResult(`p<sub>${a[b][2]}</sub>p<sub>${a[b][3]}</sub>/p<sub>${a[b][3]}</sub>i<sub>${d}</sub>=${g}`,"ratios_ext"),h=round(f/e),printResult(`p<sub>${a[b][3]}</sub>i<sub>${d}</sub>/p<sub>${a[b][2]}</sub>i<sub>${d}</sub>=${h}`,"ratios_int")),e=distance(a[c][0][0],a[c][0][1],i[0],i[1]),f=a[c][4]-e,e>=f?(g=round(a[c][4]/e),printResult(`p<sub>${a[c][2]}</sub>p<sub>${a[c][3]}</sub>/p<sub>${a[c][2]}</sub>i<sub>${d}</sub>=${g}`,"ratios_ext"),h=round(e/f),printResult(`p<sub>${a[c][2]}</sub>i<sub>${d}</sub>/p<sub>${a[c][3]}</sub>i<sub>${d}</sub>=${h}`,"ratios_int")):(g=round(a[c][4]/f),printResult(`p<sub>${a[c][2]}</sub>p<sub>${a[c][3]}</sub>/p<sub>${a[c][3]}</sub>i<sub>${d}</sub>=${g}`,"ratios_ext"),h=round(f/e),printResult(`p<sub>${a[c][3]}</sub>i<sub>${d}</sub>/p<sub>${a[c][2]}</sub>i<sub>${d}</sub>=${h}`,"ratios_int"))}function draw(){resetCanvas(),resetResults();let z=document.getElementById("canvas"),k=parseInt(document.getElementById("p").value,10),q=[];for(let r=0,E=qCount+1;r<E;++r)q.push(parseInt(document.getElementById(`q${r}`).value,10));let s=parseInt(document.getElementById("r").value,10),A=parseInt(document.getElementById("scale").value,10),B=[0,0],C=2*Math.PI/k;if(z.getContext){let l=z.getContext("2d"),g=[];g.push([0,-1*s]);for(let t=1,F=k;t<F;++t)g.push(rotate(g[t-1],C,"anticlockwise"));let a=[];a.push([0,-(s*A*1)]);for(let u=1,G=k;u<G;++u)a.push(rotate(a[u-1],C,"anticlockwise"));let v;[a,v]=translateToCanvas(a,50),drawCircle(l,B[0]+v[0],B[1]+v[1],s*A,0,2*Math.PI,"#d3d3d3");let w,f,x=0,j=[],d=[];for(let b=0,H=k;b<H;++b){void 0===q[x]&&(x=0),f=void 0!==a[b+(w=q[x++])]?b+w:b+w-k,drawLine(l,a[b][0],a[b][1],a[f][0],a[f][1],`e${b}`,"purple");let I=round(distance(g[b][0],g[b][1],g[f][0],g[f][1]));printResult(`e<sub>${b}</sub> = ${I}`,"edges"),void 0===j[b]?j[b]=[g[f],null]:j[b][1]=g[f],void 0===j[f]?j[f]=[g[b],null]:j[f][1]=g[b];let J=round(distance(a[b][0],a[b][1],a[f][0],a[f][1]));d.push([a[b],a[f],b,f,J])}for(let m=0,K=a.length;m<K;++m)drawPoint(l,a[m][0],a[m][1],`p${m}`,"green");for(let e=0,L=k;e<L;++e){if(null===j[e][0]||null===j[e][1])continue;let y=calcAngle(j[e][0],g[e],j[e][1]);if(isNaN(y)||y<=0)continue;let M=calcAngle(j[e][0],g[e],j[e][1],"radians");drawLabel(l,a[e][0],a[e][1],10,10,`θ${e}`,"blue"),printResult(`θ<sub>${e}</sub> = ${round(y)}\xb0`,"angles_deg"),printResult(`θ<sub>${e}</sub> = ${round(M)}`,"angles_rad")}let n=0,p=[];for(let h=0,N=k;h<N;++h)for(let i=0,O=d.length;i<O;++i){if(i===h)continue;let c=calcIntersection(d[h][0],d[h][1],d[i][0],d[i][1]);if(null===c||c[0]<0||c[1]<0||round(c[0])===round(d[h][0][0])&&round(c[1])===round(d[h][0][1])||round(c[0])===round(d[h][1][0])&&round(c[1])===round(d[h][1][1])||round(c[0])===round(d[i][0][0])&&round(c[1])===round(d[i][1][1])||round(c[0])===round(d[i][1][0])&&round(c[1])===round(d[i][1][1]))continue;let D=!1,o=0,P=p.length;for(;o<P;++o)if(round(p[o][0])===round(c[0])&&round(p[o][1])===round(c[1])){D=!0;break}if(D){printResult(`e<sub>${h}</sub>∩e<sub>${i}</sub>=i<sub>${o}</sub>`,"intersections"),printIntersections(d,c,h,i,n);continue}p.push(c),drawLabel(l,c[0],c[1],-10,10,`i${n}`,"red"),printResult(`e<sub>${h}</sub>∩e<sub>${i}</sub>=i<sub>${n}</sub>`,"intersections"),printIntersections(d,c,h,i,n),++n}}}qCount=0</script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name='viewport' content='width=device-width,initial-scale=1'>
    <meta name="description" content="Star polygons generation tool based on vertices and turning point(s)."/>
    <meta name="keywords" content="stars, polygons, geometry, generator, ratios, proportions, golden ratio">
    <title>Star polygons</title>
    <style>body{font-family:Georgia,serif;font-size:12px;color:#000}input,button{margin-bottom:5px}label{min-width:120px;display:inline-block}table{border-collapse:collapse}td div{padding:0 5px}td:first-child div{padding:0 5px 0 0}</style>
</head>
<body>
<form action="javascript:draw()">
    <label for="p">p <small>vertices</small></label><input id="p" type="number" min="1" value="5"/><br/>
    <label for="q0">q<sub>0</sub> <small>turning number</small></label><input id="q0" type="number" min="1" value="1"/><br/>
    <span id="additional_qs"></span>
    <button onclick="addQ();return false;">Add q</button><button onclick="removeQ();return false;">Del q</button><br/>
    <label for="r">r <small>radius</small></label><input id="r" type="number" min="0" value="1"/><br/>
    <label for="scale">scale</label><input id="scale" type="number" min="1" value="200"/><br/>
    <button type="submit">Submit</button>
</form>
<table>
    <tr>
        <td id="edges"></td>
        <td id="angles_rad"></td>
        <td id="angles_deg"></td>
        <td id="intersections"></td>
        <td id="segments"></td>
        <td id="ratios_ext"></td>
        <td id="ratios_int"></td>
        <td id="ratios_ratio"></td>
        <td id="roots"></td>
    </tr>
</table>
<div id="container"></div>
<script>function addQ(){if(!(qCount+2>parseInt(document.getElementById("p").value,10)))return++qCount,document.getElementById("additional_qs").insertAdjacentHTML("beforeend",`<span id="q${qCount}container"><label for="q${qCount}">q<sub>${qCount}</sub></label><input id="q${qCount}" type="number" min="1" value="1"/><br/></span>`)}function removeQ(){qCount<1||(document.getElementById(`q${qCount}container`).remove(),--qCount)}function resetCanvas(){document.getElementById("container").innerHTML="",document.getElementById("container").innerHTML='<canvas id="canvas" height="2000" width="2000"></canvas>'}function resetResults(){document.getElementById("edges").innerHTML="",document.getElementById("angles_rad").innerHTML="",document.getElementById("angles_deg").innerHTML="",document.getElementById("intersections").innerHTML="",document.getElementById("segments").innerHTML="",document.getElementById("ratios_ext").innerHTML="",document.getElementById("ratios_int").innerHTML="",document.getElementById("ratios_ratio").innerHTML="",document.getElementById("roots").innerHTML=""}function drawPoint(u,t,s,n="",e="#000",r=1){let i=Math.round(t),b=Math.round(s);if(u.beginPath(),u.fillStyle=e,u.arc(i,b,r,0,2*Math.PI),u.fill(),""!==n){let t=i,s=Math.round(b-r-3);u.font="Italic 10px Georgia",u.fillStyle=e,u.textAlign="center",u.fillText(n,t,s)}}function drawLabel(u,t,s,n,e,r,i="#000"){let b=Math.round(t+n),o=Math.round(s+e);u.font="Italic 10px Georgia",u.fillStyle=i,u.textAlign="center",u.fillText(r,b,o)}function drawLine(u,t,s,n,e,r="",i="#000",b=1){if(u.strokeStyle="#000",u.lineWidth=b,u.beginPath(),u.moveTo(t,s),u.lineTo(n,e),u.stroke(),""!==r){let o=Math.round((n+t)/2),a=Math.round((e+s)/2-b-3);u.font="Italic 10px Georgia",u.fillStyle=i,u.textAlign="center",u.fillText(r,o,a)}}function drawCircle(u,t,s,n,e,r,i="#000",b=1){u.strokeStyle=i,u.lineWidth=b,u.beginPath(),u.arc(t,s,n,e,r),u.stroke()}function translateToCanvas(u,t=10){const s=[],n=[];u.forEach((function(u){s.push(u[0]),n.push(u[1])}));const e=-1*Math.min(...s),r=-1*Math.min(...n),i=[];for(let s=0,n=u.length;s<n;++s)i.push([u[s][0]+e+t,u[s][1]+r+t]);return[i,[e+t,r+t]]}function dotProductMatrixAndPoint(u,t){let s=u[0],n=u[1],e=u[2],r=u[3],i=t[0],b=t[1];return[i*s+b*e,i*n+b*r]}function rotate(u,t,s="anticlockwise"){return dotProductMatrixAndPoint("anticlockwise"===s?[Math.cos(t),-Math.sin(t),Math.sin(t),Math.cos(t)]:[Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t)],u)}function distance(u,t,s,n){return Math.sqrt(Math.pow(s-u,2)+Math.pow(n-t,2))}function vectorLength(u){return Math.sqrt(Math.pow(u[0],2)+Math.pow(u[1],2))}function dotProductVectors(u,t){return u[0]*t[0]+u[1]*t[1]}function vector(u,t){return[t[0]-u[0],t[1]-u[1]]}function calcAngle(u,t,s,n="degrees"){let e=vector(t,u),r=vector(t,s),i=Math.acos(dotProductVectors(e,r)/(vectorLength(e)*vectorLength(r)));return"radians"!==n?180*i/Math.PI:i}function round(u,t=4){return Math.round((u+Number.EPSILON)*Math.pow(10,t))/Math.pow(10,t)}function printResult(u,t){document.getElementById(t).insertAdjacentHTML("beforeend",`<div>${u}</div>`)}function calcIntersection(u,t,s,n){let e=(u[0]-s[0])*(s[1]-n[1])-(u[1]-s[1])*(s[0]-n[0]),r=(u[0]-t[0])*(s[1]-n[1])-(u[1]-t[1])*(s[0]-n[0]);if(0===r||e>r||e<0&&r>0||e>0&&r<0)return null;let i=(u[0]-s[0])*(u[1]-t[1])-(u[1]-s[1])*(u[0]-t[0]),b=(u[0]-t[0])*(s[1]-n[1])-(u[1]-t[1])*(s[0]-n[0]);if(0===b||i>b||i<0&&b>0||i>0&&b<0)return null;let o=e/r,a=i/b;return o>1||o<0||a>1||a<0?null:[u[0]+o*(t[0]-u[0]),u[1]+o*(t[1]-u[1])]}function printRatios(u,t,s,n,e,r){let i,b,o,a=distance(u[s][5][0],u[s][5][1],r[0],r[1]),l=u[s][7]-a,d=distance(u[s][0][0],u[s][0][1],t[0],t[1]),$=u[s][4]-d;d>=$?(printResult(`p<sub>${u[s][2]}</sub>i<sub>${e}</sub>=${round(a)}`,"segments"),printResult(`p<sub>${u[s][3]}</sub>i<sub>${e}</sub>=${round(l)}`,"segments"),i=round(u[s][4]/d),printResult(`p<sub>${u[s][2]}</sub>p<sub>${u[s][3]}</sub>/p<sub>${u[s][2]}</sub>i<sub>${e}</sub>=${i}`,"ratios_ext"),b=round(d/$),printResult(`p<sub>${u[s][2]}</sub>i<sub>${e}</sub>/p<sub>${u[s][3]}</sub>i<sub>${e}</sub>=${b}`,"ratios_int"),o=round(b/i),printResult(`(p<sub>${u[s][2]}</sub>i<sub>${e}</sub>/p<sub>${u[s][3]}</sub>i<sub>${e}</sub>)/(p<sub>${u[s][2]}</sub>p<sub>${u[s][3]}</sub>/p<sub>${u[s][2]}</sub>i<sub>${e}</sub>)=${o}`,"ratios_ratio"),printQuadraticRoots(quadraticRoots(1,-(2+o),1),`(p<sub>${u[s][2]}</sub>i<sub>${e}</sub>/p<sub>${u[s][3]}</sub>i<sub>${e}</sub>)/(p<sub>${u[s][2]}</sub>p<sub>${u[s][3]}</sub>/p<sub>${u[s][2]}</sub>i<sub>${e}</sub>)`)):(printResult(`p<sub>${u[s][3]}</sub>i<sub>${e}</sub>=${round(l)}`,"segments"),printResult(`p<sub>${u[s][2]}</sub>i<sub>${e}</sub>=${round(a)}`,"segments"),i=round(u[s][4]/$),printResult(`p<sub>${u[s][2]}</sub>p<sub>${u[s][3]}</sub>/p<sub>${u[s][3]}</sub>i<sub>${e}</sub>=${i}`,"ratios_ext"),b=round($/d),printResult(`p<sub>${u[s][3]}</sub>i<sub>${e}</sub>/p<sub>${u[s][2]}</sub>i<sub>${e}</sub>=${b}`,"ratios_int"),o=round(b/i),printResult(`(p<sub>${u[s][3]}</sub>i<sub>${e}</sub>/p<sub>${u[s][2]}</sub>i<sub>${e}</sub>)/(p<sub>${u[s][2]}</sub>p<sub>${u[s][3]}</sub>/p<sub>${u[s][3]}</sub>i<sub>${e}</sub>)=${o}`,"ratios_ratio"),printQuadraticRoots(quadraticRoots(1,-(2+o),1),`(p<sub>${u[s][3]}</sub>i<sub>${e}</sub>/p<sub>${u[s][2]}</sub>i<sub>${e}</sub>)/(p<sub>${u[s][2]}</sub>p<sub>${u[s][3]}</sub>/p<sub>${u[s][3]}</sub>i<sub>${e}</sub>)`)),a=distance(u[n][5][0],u[n][5][1],r[0],r[1]),l=u[n][7]-a,d=distance(u[n][0][0],u[n][0][1],t[0],t[1]),$=u[n][4]-d,d>=$?(printResult(`p<sub>${u[n][2]}</sub>i<sub>${e}</sub>=${round(a)}`,"segments"),printResult(`p<sub>${u[n][3]}</sub>i<sub>${e}</sub>=${round(l)}`,"segments"),i=round(u[n][4]/d),printResult(`p<sub>${u[n][2]}</sub>p<sub>${u[n][3]}</sub>/p<sub>${u[n][2]}</sub>i<sub>${e}</sub>=${i}`,"ratios_ext"),b=round(d/$),printResult(`p<sub>${u[n][2]}</sub>i<sub>${e}</sub>/p<sub>${u[n][3]}</sub>i<sub>${e}</sub>=${b}`,"ratios_int"),o=round(b/i),printResult(`(p<sub>${u[n][2]}</sub>i<sub>${e}</sub>/p<sub>${u[n][3]}</sub>i<sub>${e}</sub>)/(p<sub>${u[n][2]}</sub>p<sub>${u[n][3]}</sub>/p<sub>${u[n][2]}</sub>i<sub>${e}</sub>)=${o}`,"ratios_ratio"),printQuadraticRoots(quadraticRoots(1,-(2+o),1),`(p<sub>${u[n][2]}</sub>i<sub>${e}</sub>/p<sub>${u[n][3]}</sub>i<sub>${e}</sub>)/(p<sub>${u[n][2]}</sub>p<sub>${u[n][3]}</sub>/p<sub>${u[n][2]}</sub>i<sub>${e}</sub>)`)):(printResult(`p<sub>${u[n][3]}</sub>i<sub>${e}</sub>=${round(l)}`,"segments"),printResult(`p<sub>${u[n][2]}</sub>i<sub>${e}</sub>=${round(a)}`,"segments"),i=round(u[n][4]/$),printResult(`p<sub>${u[n][2]}</sub>p<sub>${u[n][3]}</sub>/p<sub>${u[n][3]}</sub>i<sub>${e}</sub>=${i}`,"ratios_ext"),b=round($/d),printResult(`p<sub>${u[n][3]}</sub>i<sub>${e}</sub>/p<sub>${u[n][2]}</sub>i<sub>${e}</sub>=${b}`,"ratios_int"),o=round(b/i),printResult(`(p<sub>${u[n][3]}</sub>i<sub>${e}</sub>/p<sub>${u[n][2]}</sub>i<sub>${e}</sub>)/(p<sub>${u[n][2]}</sub>p<sub>${u[n][3]}</sub>/p<sub>${u[n][3]}</sub>i<sub>${e}</sub>)=${o}`,"ratios_ratio"),printQuadraticRoots(quadraticRoots(1,-(2+o),1),`(p<sub>${u[n][3]}</sub>i<sub>${e}</sub>/p<sub>${u[n][2]}</sub>i<sub>${e}</sub>)/(p<sub>${u[n][2]}</sub>p<sub>${u[n][3]}</sub>/p<sub>${u[n][3]}</sub>i<sub>${e}</sub>)`))}function quadraticRoots(u,t,s){let n,e,r=t*t-4*u*s;if(r>0)return n=(-t+Math.sqrt(r))/(2*u),e=(-t-Math.sqrt(r))/(2*u),[n,e];if(0===r)return n=-t/(2*u),[n,null];{let s=(-t/(2*u)).toFixed(2),n=(Math.sqrt(-r)/(2*u)).toFixed(2);return[[s,n],[s,-n]]}}function printQuadraticRoots(u,t){null===u[1]?printResult(`x<sup>2</sup>-(2+(${t}))x+1=0 → x=${round(u[0])}`,"roots"):void 0!==u[0][0]?printResult(`x<sup>2</sup>-(2+(${t}))x+1=0 → x<sub>0</sub>=${round(u[0])[0]}+${round(u[0][1])}i, x<sub>1</sub>=${round(u[1][0])} + ${round(u[1][1])}i`,"roots"):printResult(`x<sup>2</sup>-(2+(${t}))x+1=0 → x<sub>0</sub>=${round(u[0])}, x<sub>1</sub>=${round(u[1])}`,"roots")}function draw(){resetCanvas(),resetResults();const u=document.getElementById("canvas"),t=parseInt(document.getElementById("p").value,10),s=[];for(let u=0,t=qCount+1;u<t;++u)s.push(parseInt(document.getElementById(`q${u}`).value,10));const n=parseFloat(document.getElementById("r").value),e=parseInt(document.getElementById("scale").value,10),r=[0,-1*n],i=[0,0],b=[0,n*e*-1],o=2*Math.PI/t;if(u.getContext){const a=u.getContext("2d"),l=[];l.push(r);for(let u=1,s=t;u<s;++u)l.push(rotate(l[u-1],o,"anticlockwise"));let d,$=[];$.push(b);for(let u=1,s=t;u<s;++u)$.push(rotate($[u-1],o,"anticlockwise"));[$,d]=translateToCanvas($,50),drawCircle(a,i[0]+d[0],i[1]+d[1],n*e,0,2*Math.PI,"#d3d3d3");let p,c,f=0,g=[],h=[];for(let u=0,n=t;u<n;++u){void 0===s[f]&&(f=0),p=s[f++],c=void 0!==$[u+p]?u+p:u+p-t,drawLine(a,$[u][0],$[u][1],$[c][0],$[c][1],`e${u}`,"purple");let n=round(distance(l[u][0],l[u][1],l[c][0],l[c][1]));printResult(`e<sub>${u}</sub> = ${n}`,"edges"),void 0===g[u]?g[u]=[l[c],null]:g[u][1]=l[c],void 0===g[c]?g[c]=[l[u],null]:g[c][1]=l[u];let e=round(distance($[u][0],$[u][1],$[c][0],$[c][1]));h.push([$[u],$[c],u,c,e,l[u],l[c],n])}for(let u=0,t=$.length;u<t;++u)drawPoint(a,$[u][0],$[u][1],`p${u}`,"green");for(let u=0,s=t;u<s;++u){if(null===g[u][0]||null===g[u][1])continue;let t=calcAngle(g[u][0],l[u],g[u][1]);if(isNaN(t)||t<=0)continue;let s=calcAngle(g[u][0],l[u],g[u][1],"radians");drawLabel(a,$[u][0],$[u][1],10,10,`θ${u}`,"blue"),printResult(`θ<sub>${u}</sub> = ${round(t)}°`,"angles_deg"),printResult(`θ<sub>${u}</sub> = ${round(s)}`,"angles_rad")}let m=0,M=[],R=[];for(let u=0,s=t;u<s;++u)for(let t=0,s=h.length;t<s;++t){if(t===u)continue;let s=calcIntersection(h[u][0],h[u][1],h[t][0],h[t][1]);if(null===s||s[0]<0||s[1]<0||round(s[0])===round(h[u][0][0])&&round(s[1])===round(h[u][0][1])||round(s[0])===round(h[u][1][0])&&round(s[1])===round(h[u][1][1])||round(s[0])===round(h[t][0][0])&&round(s[1])===round(h[t][1][1])||round(s[0])===round(h[t][1][0])&&round(s[1])===round(h[t][1][1]))continue;let n=!1,e=0,r=M.length;for(;e<r;++e)if(round(M[e][0])===round(s[0])&&round(M[e][1])===round(s[1])){n=!0;break}let i=calcIntersection(h[u][5],h[u][6],h[t][5],h[t][6]);n?(printResult(`e<sub>${u}</sub>∩e<sub>${t}</sub>=i<sub>${e}</sub>`,"intersections"),printRatios(h,s,u,t,m,i)):(M.push(s),R.push(i),drawLabel(a,s[0],s[1],-10,10,`i${m}`,"red"),printResult(`e<sub>${u}</sub>∩e<sub>${t}</sub>=i<sub>${m}</sub>`,"intersections"),printRatios(h,s,u,t,m,i),++m)}}}qCount=0;</script>
</body>
</html>